(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{926:function(n,t,e){"use strict";e.r(t);var s=e(114),a=Object(s.a)({},(function(){var n=this.$createElement,t=this._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":this.$parent.slotKey}},[t("h1",{attrs:{id:"excel导入组件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#excel导入组件"}},[this._v("#")]),this._v(" Excel导入组件")]),this._v(" "),t("hr"),this._v(" "),t("common-code-forma",[t("docsComponents-UploadExcel-index"),this._v(" "),t("highlight-code",{attrs:{slot:"codeText"},slot:"codeText"},[t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[this._v('<template>\n   <div class="excel-upload" style="width: 100%;">\n      <t-layout sectionTitle="Excel上传组件">\n        <step-wizard\n          style="min-height:400px;"\n          :stepData="stepData"\n          :lastBtnTitle="lastBtnTitle"\n          :active="active"\n          :successTitle="successTitle"\n          @complete="complete"\n        >\n          \x3c!-- 1.上传文件 --\x3e\n          <template #first>\n            <div class="content-main">\n              <upload-excel\n                :on-success="handleSuccess"\n                :before-upload="beforeUpload"\n                :selectedFileText="fileName"\n              />\n              <div class="hint t-margin-top-10">\n                <i class="i-icon icon iconfont icon-prompt t-padding5 text-primary" />&nbsp;\n                <b>提示：</b>\n                <span class="text-muted">\n                  1、如果您还没有导入模板，请点击\n                  <a @click="downloadTemplate">发票导入模板下载.xlsx</a>\n                </span>\n                <br />\n                <span\n                  class="text-muted"\n                  style="margin-left: 76px;"\n                >2、相同的发票不能重复上传，若已上传的数据不正确，请先删除，再重新上传。(发票号码和发票代码相同的为同一张发票)</span>\n              </div>\n            </div>\n          </template>\n          \x3c!-- 2.核对信息 --\x3e\n          <template #second>\n            <div class="content-main">\n              <div class="alert-content">\n                <div class="alert alert-info text-center">\n                  <i class="i-icon icon iconfont icon-prompt t-padding5 text-primary" />&nbsp;\n                  <span>\n                    您本次共导入\n                    <span class="text-danger">importRecNum</span>条记录\n                  </span>\n                </div>\n              </div>\n              <el-table\n                :data="tableData"\n                border\n                highlight-current-row\n                style="width: 100%;margin-top:20px;"\n              >\n                <el-table-column\n                  v-for="item of tableHeader"\n                  :key="item"\n                  :prop="item"\n                  :label="item"\n                  show-overflow-tooltip\n                  min-width="220"\n                  align="center"\n                />\n              </el-table>\n            </div>\n          </template>\n        </step-wizard>\n      </t-layout>\n    </div>\n</template>\n<script>\n    export default {\n        data () {\n          return {\n            active: 0,\n            stepData: [\n              {\n                id: 1,\n                title: \'上传文件\',\n                slotName: \'first\',\n                btnArr: [\n                  {\n                    btnTitle: \'下一步\',\n                    fn: this.next\n                  }\n                ]\n              },\n              {\n                id: 2,\n                title: \'核对信息\',\n                slotName: \'second\',\n                btnArr: [\n                  {\n                    btnTitle: \'上一步\',\n                    fn: this.stepBack\n                  },\n                  {\n                    btnTitle: \'下一步\',\n                    fn: this.submitBtn\n                  }\n                ]\n              },\n              {\n                id: 3,\n                title: \'完成\'\n              }\n            ],\n            lastBtnTitle: \'完成\',\n            successTitle: \'发票导入完成...\',\n            fileName: \'\',\n            importRecNum: 0, // 导入多少条数据\n            tableData: [],\n            tableHeader: []\n          }\n        },\n        methods: {\n          beforeUpload (file) {\n            this.fileName = file.name\n            const isLt1M = file.size / 1024 / 1024 < 1\n            if (isLt1M) {\n              return true\n            }\n            this.$message({\n              message: \'请不要上传大于1m的文件.\',\n              type: \'warning\'\n            })\n            return false\n          },\n          handleSuccess ({ results, header }) {\n            this.importRecNum = results.length\n            this.tableData = results\n            this.tableHeader = header\n          },\n          // 第二步确认提交\n          submitBtn (val) {\n            this.active += 2\n            this.fileName = \'\'\n          },\n          // 第一步--下一步\n          next () {\n            if (this.fileName) {\n              this.active += 1\n            } else {\n              this.$message({\n                message: \'请先上传文件.\',\n                type: \'warning\'\n              })\n              return false\n            }\n          },\n          // 第二步---上一步\n          stepBack () {\n            this.active -= 1\n          },\n          // 第三步完成\n          complete () {\n            this.active = 0\n          },\n          // 下载模板\n          downloadTemplate () {\n            console.log(\'下载模板\')\n          }\n        }\n    }\n<\/script>\n')])])])])],1)],1)}),[],!1,null,null,null);t.default=a.exports}}]);